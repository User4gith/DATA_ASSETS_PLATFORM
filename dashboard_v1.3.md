### **“数智之眼” PRD - V2.1 终稿**

#### **2.2.1 模块：首页仪表盘 (Dashboard)**

**1. 模块概述 (Module Overview)**

作为用户登录后看到的第一个页面，仪表盘是整个平台的“信息中枢”和“工作起点”。它旨在为不同角色的用户提供一个个性化、信息聚合的工作台，让用户无需跳转即可快速掌握其最关心的核心状态、待办任务和常用资源，并能一键触达高频操作。

**2. 核心设计目标 (Core Design Goals)**

*   **信息效率 (Efficiency)**: 让用户在30秒内获取最关键的信息。
*   **行动导向 (Action-Oriented)**: 将“事找人”，驱动用户完成待办任务。
*   **业务透视 (Business Insight)**: 将技术资产与业务价值关联，提供管理者视角。
*   **高度个性化 (Personalization)**: 适应不同用户的独特工作流，让工具为人服务。

**3. 页面布局与交互 (Layout & Interaction)**

*   **布局**: 采用响应式24列栅格系统。标准 `1920px` 宽度下，推荐采用3列或2+1列布局。
*   **交互**:
    *   所有卡片组件遵循统一的UI规范（圆角、阴影、标题栏）。
    *   支持拖拽排序和显隐配置，实现个性化布局。
    *   数据加载时显示骨架屏，加载失败时提供友好提示和重试机制。
*   **默认布局建议 (管理者角色)**:
    *   **第一行**: [核心指标卡 (占 1/2 宽度)], [覆盖的业务主题卡 (占 1/2 宽度)]
    *   **第二行**: [我的工作台 (占 1/3 宽度)], [热门资产榜 (占 1/3 宽度)], [我的收藏 & 最近访问 (占 1/3 宽度)]
    *   **第三行**: [平台公告 (单独一行或放置于侧边栏)]

---
**4. 功能点详细描述 (Detailed Feature Specifications)**
---

##### **4.1 功能点: 核心指标卡 (KPI Metrics Card)**
*   **PBI-ID**: `DB-01`
*   **功能点概述**: 以2x2或2x3的网格布局展示4-6个平台级宏观数据指标，是衡量数据健康度的核心窗口。
*   **用户故事**: “作为管理者，我希望一登录就能看到公司的数据家底（资产总数、核心占比）和健康度（质量分、告警数），并了解其变化趋势。”
*   **业务规则**:
    1.  系统管理员可在后台配置仪表盘默认显示的指标项（从下方指标库中选择）。
    2.  管理员可配置每个指标的环比周期（日环比/周环比）。
    3.  指标计算任务需每日/小时级定时执行，并将结果缓存，确保前端快速加载。
*   **视觉与交互设计**:
    *   **单指标展示**: 每个指标区域包含：指标名称、醒目的指标数值、日/周环比变化（使用红/绿颜色和↑/↓箭头）、可点击的 `(i)` 信息图标。
    *   **悬浮 `(i)` 图标**: 显示该指标的详细“业务定义”浮窗。
    *   **点击指标区域**: 跳转到该指标对应的详细分析报表页面。
*   **核心指标库 (Metric Library)**:

| 指标名称 (Metric Name) | 目标用户 (Target User) | 业务定义与价值 (Business Definition & Value) | 计算逻辑/公式 (Calculation Logic/Formula) | 更新频率 (Update Freq.) | 点击交互 (Click Action) |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **数据资产总数** | 管理层、治理团队 | **定义**: 平台内已接入并处于“在线”状态的数据资产（主要是数据表）的总数量。<br>**价值**: 反映公司数据规模的基线，是衡量数据化广度的核心指标。 | `SELECT COUNT(DISTINCT asset_id) FROM asset_master WHERE status = 'online'` | 每日 | 跳转到「数据资产中心」，展示所有在线资产列表。 |
| **核心资产占比** | 管理层、治理团队 | **定义**: 被标记为“核心资产”的数量占总资产数量的百分比。<br>**价值**: 评估高价值数据资产的集中度，反映数据战略的聚焦程度和ROI。 | `(COUNT(*) FROM asset_master WHERE status = 'online' AND level = 'core') / (COUNT(*) FROM asset_master WHERE status = 'online') * 100%` | 每日 | 跳转到「数据资产中心」，筛选出所有“核心资产”。 |
| **数据质量平均分** | 管理层、治理团队 | **定义**: 所有在线资产的数据质量得分的加权平均值（核心资产权重更高）。<br>**价值**: 单一指标宏观反映全公司数据的整体健康度和可信赖程度。 | `SUM(dq_score * weight) / SUM(weight) WHERE status = 'online'`<br>*(注: weight可由管理员配置，默认核心资产为3，普通为1)* | 每日 | 跳转到「数据质量」模块的全局监控大盘。 |
| **昨日严重告警数** | 数据工程师、管理层 | **定义**: 过去24小时内，由数据质量监控系统产生的“严重”或“致命”级别告警的总数。<br>**价值**: 直观反映了近期数据生产的稳定性，是衡量数据运维风险的关键运营指标。 | `SELECT COUNT(*) FROM dq_alerts WHERE alert_level IN ('critical', 'fatal') AND alert_time >= [yesterday]` | 小时级 | 跳转到「监控与告警」中心，筛选出昨日所有严重告警。 |
| **无主资产数** | 治理团队、管理层 | **定义**: 资产负责人字段为空或为“默认”的在线资产数量。<br>**价值**: 衡量数据治理的责任制落实情况，是关键的数据风险敞口指标。无主资产意味着无人负责其质量和安全。 | `SELECT COUNT(*) FROM asset_master WHERE status = 'online' AND (owner_id IS NULL OR owner_id = 'default_user')` | 每日 | 跳转到「数据治理」模块的“无主资产”待办列表，方便进行认领分配。 |
| **元数据覆盖率** | 治理团队、分析师 | **定义**: 拥有完整业务描述（非空）的在线资产占总资产的百分比。<br>**价值**: 衡量数据资产的“可理解性”。高覆盖率意味着数据更容易被发现和正确使用，降低沟通成本。 | `(COUNT(*) FROM asset_master WHERE status = 'online' AND business_desc IS NOT NULL AND business_desc != '') / (COUNT(*) FROM asset_master WHERE status = 'online') * 100%` | 每日 | 跳转到一份报表，列出所有“元数据缺失”的资产，并显示其负责人。 |
| **周活跃用户数 (WAU)** | 产品经理、管理层 | **定义**: 过去7天内，至少登录过一次本平台的独立用户数。<br>**价值**: 这是衡量“数智之眼”平台自身使用率和推广效果的核心指标，直接关系到平台建设的价值体现。 | `SELECT COUNT(DISTINCT user_id) FROM audit_logs WHERE action = 'login' AND event_time >= [7_days_ago]` | 每日 | 跳转到平台运营分析报表，展示用户活跃度、留存率等详细趋势图。 |
*   **异常状态**:
    *   **加载中**: 卡片显示骨架屏。
    *   **加载失败**: 显示“核心指标加载失败”，并提供“重试”按钮。

---

##### **4.2 功能点: 我的工作台 (My Workspace / To-Do List)**
*   **PBI-ID**: `DB-02`
*   **功能点概述**: 一个高度个性化和行动导向的组件，聚合了所有需要当前用户处理、审批或关注的任务，实现“事找人”。
*   **用户故事**: 
    *   **管理者**: “我需要一个地方快速处理下属的权限申请，而不是去邮件或IM工具里翻找。”
    *   **数据工程师**: “当分配给我的数据质量问题出现时，我希望能在首页第一时间看到并直接点击去处理。”
*   **业务规则**:
    1.  卡片内使用页签 (Tabs) 区分不同类型的任务。
    2.  每个页签右上角显示该类任务的未处理数量角标。
    3.  默认显示每个类别的最新5条任务，按时间倒序排列。
    4.  **页签分类**:
        *   **待我审批**: 显示需要当前用户审批的流程，如权限申请、发布流程。列表项应包含：`[申请人] 申请 [操作内容]`、`申请时间`。
        *   **待我处理**: 显示已分配给当前用户的任务，如数据质量告警、修复工单。列表项应包含：`[告警/工单标题]`、`告警级别`、`时间`。
        *   **我的关注**: 显示用户主动关注的或由其创建的异常任务，如我创建的ETL任务失败。列表项应包含：`[任务名称]`、`失败状态`、`时间`。
*   **逻辑流程**: 前端通过 `GET /api/workspace/todos` 接口请求，后端聚合来自工作流引擎、数据质量中心、调度系统等多个模块的数据，返回给前端。
*   **交互**:
    *   点击列表项，直接跳转到该任务对应的详情页或处理页。
    *   卡片底部提供一个“查看全部”链接，点击后跳转到统一的任务中心页面。
*   **异常状态**:
    *   **无待办**: 卡片显示空状态插画和友好文案，如“太棒了！所有任务都已处理完毕。”
    *   **加载失败**: 显示“待办列表加载失败”，并提供“重试”按钮。

---

##### **4.3 功能点: 我的收藏 & 最近访问 (Favorites & Recently Viewed)**
*   **PBI-ID**: `DB-03`
*   **功能点概述**: 提供快捷入口，让用户能快速回到他们高频使用或近期访问过的数据资产。
*   **用户故事**: “我每周都要看‘用户活跃度周报’这张表，希望能收藏它，在首页点一下就能进去，不用每次都去搜索。”
*   **业务规则**:
    1.  卡片内使用页签 (Tabs) 区分“我的收藏”和“最近访问”。
    2.  **我的收藏**:
        *   由用户在资产详情页通过点击“收藏”（星形）图标主动添加/移除。
        *   收藏列表没有数量上限，按收藏时间倒序排列。
    3.  **最近访问**:
        *   系统自动记录用户访问过的资产详情页。
        *   仅保留最近访问的10个**唯一**资产记录，采用LIFO（后进先出）策略。
*   **逻辑流程**:
    *   收藏列表通过 `GET /api/user/favorites` 获取。
    *   最近访问列表从用户活动日志或专用缓存中通过 `GET /api/user/recent-views` 获取。
*   **交互**:
    *   点击任一列表项，新开标签页跳转到该资产的详情页。
*   **异常状态**:
    *   **列表为空**: 显示相应的引导文案，如“您尚未收藏任何资产，快去探索发现吧！”或“您的足迹将记录在此处。”

---

##### **4.4 功能点: 平台公告 (Announcements)**
*   **PBI-ID**: `DB-04`
*   **功能点概述**: 平台与用户沟通的重要渠道，用于发布版本更新、规范变更、系统维护等官方信息。
*   **用户故事**: “我希望在首页及时看到平台的官方通知，比如系统什么时候升级维护，好提前安排工作，避免数据任务受影响。”
*   **业务规则**:
    1.  公告由平台管理员在后台管理系统中创建、编辑和发布。
    2.  公告属性包括：标题、正文、发布时间、发布人、重要性级别、是否置顶。
    3.  仪表盘卡片默认显示最新的3-5条公告。
    4.  “置顶”的公告将无视发布时间，始终显示在列表最顶部。
*   **逻辑流程**: 前端通过 `GET /api/announcements?limit=5` 接口获取公告列表。
*   **交互**:
    *   点击公告标题，通过模态框（Modal）展示公告全文。
    *   卡片右上角提供“更多”链接，点击后跳转到完整的公告列表页面。
*   **异常状态**:
    *   **无公告**: 卡片可被隐藏，或显示“暂无最新公告”。
    *   **加载失败**: 显示“公告加载失败”。

---

##### **4.5 功能点: 热门资产榜 (Hot Assets)**
*   **PBI-ID**: `DB-05`
*   **功能点概述**: 通过量化的热度模型，展示平台内最受欢迎、使用最频繁的数据资产，辅助用户进行数据发现。
*   **用户故事**: “作为一名业务分析师，我想快速了解我们部门哪些是大家都在用的核心数据表，热门榜单能给我很好的指引，避免我重复造轮子。”
*   **业务规则**:
    1.  **热度分计算**:
        *   后台每日定时任务执行计算。
        *   **公式**: `热度分 = w1 * (近30日访问UV) + w2 * (近30日查询次数) + w3 * (总收藏数) + w4 * (下游血缘节点数)`
        *   权重系数 (w1, w2, w3, w4) 应由管理员在后台配置，以适应不同阶段的运营重点。
    2.  榜单展示TOP 10的热门资产。
    3.  列表项应包含：`排名`、`资产名称`、`资产类型` (表/报表)、`所属业务主题`、`负责人`。
*   **逻辑流程**: 前端通过 `GET /api/assets/hot-list` 接口直接获取预计算好的榜单结果。
*   **交互**:
    *   点击资产名称，跳转到该资产的详情页。
    *   鼠标悬浮在负责人上，可显示其详细联系方式。
*   **异常状态**:
    *   **榜单生成中**: 显示“热门榜单正在生成中，请稍后查看”。
    *   **无数据**: 显示空状态，引导用户多探索平台。

---

##### **4.7 功能点: 覆盖的业务主题卡 (Business Domain Coverage Card)**
*   **PBI-ID**: `DB-07`
*   **功能点概述**: 通过直观的矩形树图 (Treemap) 可视化，展示公司数据资产在各个业务主题的分布、数量和健康度。
*   **用户故事**: “我想一目了然地看到我们公司的数据主要集中在哪些业务领域，比如‘销售’、‘用户增长’还是‘供应链’。同时，我也想知道哪个业务域的数据质量最高，这能帮助我判断数据投入与业务战略是否匹配。”
*   **业务规则**:
    1.  **业务主题**: 数据治理团队需预先在系统中维护一套层级化的业务主题（业务域）树。
    2.  **数据计算**: 后台每日定时任务预聚合每个业务主题下的资产总数、核心资产数、数据质量平均分等指标，并将结果以层级化JSON格式缓存。
    3.  **可视化映射**:
        *   **矩形面积**: 与该业务主题下的资产总数成正比。
        *   **颜色**: 色彩饱和度或色系与该主题的数据质量平均分相关联（例如，从红到绿的色阶）。
*   **逻辑流程**: 前端通过 `GET /api/dashboard/business-coverage` 接口获取预计算好的JSON数据，然后使用图表库渲染。
*   **交互**:
    *   **悬浮 (Hover)**: 在任一色块上显示信息浮窗（Tooltip），包含：业务主题名称、资产总数、核心资产数、数据质量平均分。
    *   **点击 (Click)**: 跳转到「数据资产中心」，并自动应用该业务主题的筛选条件。
    *   **双击 (Double Click)**: 如果该主题有子主题，则下钻到下一层级视图。
*   **异常状态**:
    *   **加载中**: 显示图表骨架屏。
    *   **加载失败**: 显示“业务主题视图加载失败”，并提供“重试”按钮。
    *   **无数据**: 显示“暂无业务主题数据，请联系数据治理团队进行配置”。