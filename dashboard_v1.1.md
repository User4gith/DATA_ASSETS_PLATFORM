好的，我们现在聚焦于 **“首页仪表盘 (Dashboard)”** 这一个模块，并按照 V2.0 PRD 的详尽格式，为其中的每一个功能点（即每一个卡片组件）进行细致入微的描述。

---

### **“数智之眼” PRD - 模块详细描述**

#### **模块：2.2.1 首页仪表盘 (Dashboard)**

*   **模块概述**：作为用户登录后看到的第一个页面，仪表盘是整个平台的“信息中枢”和“工作起点”。它旨在为不同角色的用户提供一个个性化、信息聚合的工作台，让用户无需跳转即可快速掌握其最关心的核心状态、待办任务和常用资源，并能一键触达高频操作。

---

##### **功能点 1: 核心指标卡 (KPI Metrics Card)**

*   **PBI-ID**: `DB-01`
*   **功能点概述**: 以最直观的方式，向用户展示平台级的宏观数据资产状况，尤其对于管理层和数据治理团队，这是衡量平台价值和数据健康度的核心窗口。
*   **用户故事**:
    *   **企业管理者**: “作为一个管理者，我希望一登录就能看到公司的数据资产总量、核心资产占比这些关键数字，以及它们的近期变化趋势，这能让我对公司的数据家底和健康度有个快速、宏观的了解。”
    *   **数据治理负责人**: “作为一个数据治理负责人，我需要每天关注平台的数据质量平均分和昨日新增的告警数，以便我能及时评估治理工作的成效并发现潜在的系统性风险。”
*   **业务规则**:
    1.  所有指标均为全平台范围的实时或准实时聚合数据。
    2.  数据默认每小时自动刷新一次，用户也可手动刷新。
    3.  指标下方应展示与上一日/周的环比变化，使用箭头和百分比表示增长或下降。
    4.  “数据质量分”：采用加权平均计算，权重可由管理员在后台配置，默认核心资产权重为普通资产的3倍。
    5.  每个指标都可点击，点击后跳转到「数据统计与报表」模块的对应主题分析大盘。
*   **逻辑流程**:
    1.  用户登录并进入仪表盘。
    2.  前端请求 `GET /api/dashboard/kpi` 接口。
    3.  后端接收请求，从预先计算好的缓存层（如 Redis）或轻量级聚合表中获取以下指标：
        *   `total_assets` (资产总数)
        *   `core_assets` (核心资产数)
        *   `avg_dq_score` (数据质量平均分)
        *   `new_alerts_yesterday` (昨日新增告警数)
        *   以及各项指标的日环比数据。
    4.  前端接收到数据后，渲染到“核心指标卡”组件中。
*   **输入/输出**:
    *   **输入**: 用户登录凭证（用于权限校验）。
    *   **输出**: 一组包含指标名称、数值、环比变化的可视化卡片。
        *   示例数据：`{ "name": "资产总数", "value": 12,834, "change_rate": "+1.2%" }`
*   **异常状态**:
    *   **数据加载中**: 卡片区域显示骨架屏（Skeleton）占位。
    *   **数据加载失败 (API 5xx 或超时)**: 卡片区域显示“数据加载失败”，并提供一个“重试”按钮。
    *   **数据为空 (系统初始化)**: 显示数值为 "0" 或 "--"，环比无数据。

---

##### **功能点 2: 我的工作台 (My Workspace / To-Do List)**

*   **PBI-ID**: `DB-02`
*   **功能点概述**: 这是一个高度个性化和行动导向的组件，聚合了所有需要当前用户立即处理或关注的任务，旨在将“人找事”变为“事找人”，极大提升工作效率。
*   **用户故事**:
    *   **数据工程师**: “作为一个数据工程师，我每天最关心的就是有没有我负责的数据任务失败了，或者有没有我负责的数据表收到了质量告警。我希望在首页就能看到这些待办事项，并能一键点击去处理。”
    *   **数据分析师 Leader**: “作为一个团队负责人，我经常需要审批团队成员的数据访问权限申请。我希望首页能有个列表提醒我有多少待我审批的单子，避免遗忘导致业务进度延误。”
*   **业务规则**:
    1.  此组件显示的数据严格与当前登录用户相关。
    2.  列表分为不同的页签（Tab），如“待我审批”、“待我处理”、“我的任务”，默认显示有内容的第一个页签。
    3.  每个页签旁边应显示待办事项的数量角标。若数量为0，则不显示。
    4.  每个列表项都应是可点击的链接，直接跳转到对应的处理页面。
    5.  列表最多显示最新的5条记录，底部提供“查看全部”链接。
    6.  该组件数据应具备更高的刷新频率，如每5分钟自动刷新一次。
*   **逻辑流程**:
    1.  用户进入仪表盘。
    2.  前端请求 `GET /api/dashboard/workspace` 接口，携带当前用户信息。
    3.  后端根据用户ID，分别查询审批中心、告警中心、任务调度中心等模块，获取该用户的待办事项列表。
    4.  聚合数据后返回给前端。
    5.  前端渲染成带有多页签的列表。
*   **输入/输出**:
    *   **输入**: 用户ID。
    *   **输出**: 一个结构化的JSON对象，包含不同类别的待办事项列表。
        *   示例数据：`{ "approvals": [ { "id": "APP001", "title": "张三申请访问'dm_user_profile'", "time": "10分钟前" } ], "alerts": [], "tasks": [ ... ] }`
*   **异常状态**:
    *   **无任何待办事项**: 组件显示一个友好的空状态，包含一个插画和文字“太棒了！所有任务都已完成。”。
    *   **部分数据源失败**: 如果某个待办类别（如“我的任务”）的接口失败，该页签应显示加载失败提示，但不影响其他页签的正常显示。

---

##### **功能点 3: 我的收藏 & 最近访问 (Favorites & Recently Viewed)**

*   **PBI-ID**: `DB-03`
*   **功能点概述**: 为用户提供快速回到他们最关心或最常使用的数据资产的快捷入口，是提升“找数”效率的关键组件。
*   **用户故事**:
    *   **数据分析师**: “我每周都要看‘用户活跃度周报’和‘核心渠道转化漏斗’这两个表，我希望能把它们收藏起来，每次登录后在首页点一下就能进去，而不是每次都要在几千张表里搜索。”
    *   **业务人员**: “我昨天刚看过一个‘季度销售总结’的数据表，今天想再看一下，但我忘了全名。我希望首页能有个‘最近访问’列表，让我能快速找到它。”
*   **业务规则**:
    1.  “我的收藏”由用户主动操作（在资产详情页点击收藏按钮）添加，数据持久化存储。
    2.  “最近访问”由系统自动记录用户访问资产详情页的行为，只保留最新的10条记录，是一个先进先出的队列。
    3.  这两个功能通常可以整合在一个卡片中，通过页签（Tab）切换。
    4.  列表项应显示资产名称和类型图标（如：表、报表、指标）。
*   **逻辑流程**:
    *   **收藏**: 用户在资产详情页点击“收藏” -> 前端发送 `POST /api/favorites` 请求 -> 后端记录用户与资产的收藏关系。
    *   **最近访问**: 用户访问资产详情页 -> 前端（或后端中间件）记录一条访问日志到用户的最近访问列表中。
    *   **仪表盘加载**: 前端请求 `GET /api/dashboard/shortcuts` -> 后端返回该用户的收藏列表和最近访问列表 -> 前端渲染。
*   **输入/输出**:
    *   **输入**: 用户ID。
    *   **输出**: 两个列表，每个列表项包含资产ID、名称、类型、URL。
*   **异常状态**:
    *   **列表为空**: 显示空状态提示，如“您还没有收藏任何资产，快去数据资产中心发现并收藏吧！”。

---

##### **功能点 4: 平台公告 (Announcements)**

*   **PBI-ID**: `DB-04`
*   **功能点概述**: 作为平台与用户沟通的重要渠道，用于发布版本更新、规范变更、数据维护等重要信息。
*   **用户故事**:
    *   **所有用户**: “我希望能在首页及时看到平台的官方通知，比如系统要在什么时候升级维护，或者发布了新的数据命名规范，这样我好提前安排工作，并遵守最新的规则。”
*   **业务规则**:
    1.  只显示最新的3-5条公告标题。
    2.  支持“置顶”功能，被置顶的公告始终显示在最上方。
    3.  标题过长时应做截断处理。
    4.  点击标题可弹出对话框或跳转到详情页查看全文。
    5.  卡片右上角有“更多”链接，跳转到公告列表页。
*   **逻辑流程**:
    1.  管理员在后台发布公告。
    2.  用户进入仪表盘，前端请求 `GET /api/announcements?limit=5`。
    3.  后端从数据库查询最新的、已发布的公告（按置顶和发布时间排序）返回。
    4.  前端渲染列表。
*   **输入/输出**:
    *   **输入**: 无。
    *   **输出**: 公告列表，每项包含ID、标题、发布时间、是否置顶。
*   **异常状态**:
    *   **无公告**: 显示“暂无公告”。

---

##### **功能点 5: (可选) 热门资产榜 (Hot Assets)**

*   **PBI-ID**: `DB-05`
*   **功能点概述**: 通过展示平台内最受欢迎的数据资产，帮助新用户或分析师发现高价值数据，促进数据在组织内的流动和复用。
*   **用户故事**:
    *   **新入职的数据分析师**: “我刚来公司，对数据不太熟，不知道哪些是大家都在用的核心表。如果首页能有个‘热门榜单’，我就能快速了解哪些是经过验证的高价值数据，从而更快地开展工作。”
*   **业务规则**:
    1.  热度分基于近30天的访问量、查询量、收藏数、下游引用数等指标加权计算得出。
    2.  热度分每日定时任务计算一次并缓存，无需实时计算。
    3.  榜单可按“数据表”、“指标”等资产类型切换。
*   **逻辑流程**:
    1.  每日凌晨，后台调度一个定时任务，聚合日志数据，计算所有资产的热度得分，并将TOP 20的结果存入缓存。
    2.  用户访问仪表盘，前端请求 `GET /api/dashboard/hot-assets`。
    3.  后端直接从缓存中读取榜单数据返回。
*   **输入/输出**:
    *   **输入**: 无。
    *   **输出**: 热门资产列表，包含排名、资产名称、热度值、负责人。
*   **异常状态**:
    *   **榜单数据未生成**: 显示“热门榜单正在计算中，请稍后查看”。

##### **功能点 6: 个性化布局 (Dashboard Customization)**

*   **PBI-ID**: `DB-06`
*   **功能点概述**: 赋予用户自定义仪表盘布局的能力。这能让平台从一个“统一的看板”进化为每个用户“专属的驾驶舱”，极大提升高阶用户和特定角色用户的使用满意度和效率。
*   **用户故事**:
    *   **数据分析师 Leader**: “作为一个团队负责人，我最关心的是‘我的工作台’（审批任务）和‘热门资产榜’（了解团队动向），而平台级的‘核心指标’对我日常工作不是最优先的。我希望能把前两个卡片拖到最上面，并隐藏掉我不关心的‘平台公告’，让我的首页聚焦于我的管理工作。”
    *   **企业管理者**: “默认的布局很好，但随着我对数据的理解加深，我可能希望将‘数据质量概览’和‘核心资产告警’放在一起对比查看。我需要一个简单的方式来调整它们的顺序。”
*   **业务规则**:
    1.  用户可以通过拖拽（Drag and Drop）的方式自由调整卡片的位置和顺序。
    2.  每个卡片的右上角提供一个“关闭”图标（`X`），用户可以点击隐藏不希望看到的卡片。
    3.  页面右上角应提供一个“自定义仪表盘”或类似的入口按钮，点击后进入“编辑模式”。
    4.  在“编辑模式”下，页面会显示一个“添加组件”的按钮，点击后弹出侧边栏或模态框，列出所有可用的（包括已被隐藏的）卡片组件，用户可以选择添加。
    5.  用户的布局修改会自动保存，并与个人账户绑定，下次登录时保持其自定义布局。
    6.  必须提供一个“恢复默认布局”的选项，让用户可以一键撤销所有自定义设置。
    7.  不同角色的默认布局由系统管理员在后台配置。
*   **逻辑流程**:
    1.  用户点击“自定义仪表盘”进入编辑模式。
    2.  用户拖拽卡片 A 到卡片 B 的位置。前端实时更新视图。
    3.  用户点击“保存”或系统在操作后自动保存。
    4.  前端将当前所有卡片的布局信息（如 `[{id: "DB-01", position: 1}, {id: "DB-02", position: 2}]`）通过 `POST /api/user/dashboard-layout` 接口发送给后端。
    5.  后端将该布局配置（JSON格式）保存到该用户的个人配置表中。
    6.  下次用户加载仪表盘时，前端会先请求该布局配置接口，然后根据返回的配置动态渲染卡片顺序和显隐。
*   **输入/输出**:
    *   **输入**: 用户ID，布局配置JSON。
    *   **输出**: 保存成功的确认信息。/ 获取布局配置时返回配置JSON。
*   **异常状态**:
    *   **保存失败**: 提示用户“布局保存失败，请检查网络后重试”。
    *   **无自定义配置**: 首次加载或用户重置后，后端返回空，前端则加载该角色的默认布局。
    *   **组件ID失效**: 如果用户保存的布局中包含了后续版本已下线的组件ID，前端在渲染时应能平滑地忽略该组件，不导致页面崩溃。

---

#### **2.2.1.7 页面布局与线框图参考 (Page Layout & Wireframe Reference)**

*   **整体布局**:
    *   页面采用响应式栅格布局（基于24列栅格系统）。
    *   在标准 `1920px` 宽度下，推荐采用3列布局。
    *   **默认布局示例 (管理者角色)**:
        *   **第一行**: [核心指标卡 (占2/3宽度)], [我的工作台 (占1/3宽度)]
        *   **第二行**: [热门资产榜 (占1/3宽度)], [我的收藏 & 最近访问 (占1/3宽度)], [平台公告 (占1/3宽度)]
    *   **默认布局示例 (工程师角色)**:
        *   **第一行**: [我的工作台 (占2/3宽度)], [核心指标卡 (占1/3宽度)]
        *   **第二行**: [我的收藏 & 最近访问 (占1/3宽度)], [平台公告 (占1/3宽度)], [热门资产榜 (占1/3宽度)]
*   **交互细节**:
    *   所有卡片应有统一的标题栏、边框、圆角和阴影样式，遵循之前制定的《设计规范》。
    *   鼠标悬浮在卡片上时，应有轻微的阴影加深效果，以提供交互反馈。
*   **线框图参考**:
    *   所有具体的组件布局、间距、交互细节，请参考以下设计文档（此为示例，实际项目中应链接到Figma, Axure等具体地址）：
        *   **`WF-DASH-01`**: 仪表盘默认视图线框图
        *   **`WF-DASH-02`**: 仪表盘编辑模式线框图
        *   **`UI-DASH-01`**: 仪表盘高保真视觉设计稿

---

#### **首页仪表盘模块总结**

至此，我们已经完整、详细地描述了“首页仪表盘”模块下的所有核心功能点。

**本模块的核心设计目标是**：
1.  **信息效率 (Efficiency)**: 让用户在最短时间内获取最关键的信息。
2.  **行动导向 (Action-Oriented)**: 驱动用户完成待办任务，而不是仅仅展示信息。
3.  **高度个性化 (Personalization)**: 适应不同用户的独特工作流，让工具为人服务。

通过以上 `DB-01` 至 `DB-06` 六个功能点的设计，我们为实现这些目标提供了坚实的产品基础。前端和后端团队可以基于此文档进行技术方案设计和开发工作。

**下一模块将详细描述“2.2.2 数据资产中心”。**